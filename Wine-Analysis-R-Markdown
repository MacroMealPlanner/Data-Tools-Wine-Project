---
output: html_document
title: "Comparison of Variety, Score, and Price of Wines from Different Countries"
authors:
- name: Luke Barousse, Mariel Behnke, Chad Giganti, Alex Masica, Eric Weien
  affiliation: Ohio State University
abstract: "(INSERT TEXT)"
keywords: "wine, reviews, crunk"
date: "`r format(Sys.time(), '%B %d, %Y')`"
geometry: margin=1in
fontfamily: mathpazo
fontsize: 11pt
spacing: double
endnote: no
---


# Introduction


# Initial analysis

First, we started by installing all the necessary packages and loading the data set.

```{r packages, message = FALSE, warning = FALSE}
library(tidyverse)
library(dplyr)
library(readr)
winemag_data_130k_v2 <- read_csv("Downloads/wine-reviews/winemag-data-130k-v2.csv")
winedata <- winemag_data_130k_v2
```

Next we took an intial look at the data set after importing it.

```{r dataimport}
glimpse(winedata)
```
(Write a description of the data set)

### Average Reviews Per Country

```{r avgreviews}
winedata %>%
  filter(country  %in% c("US", "France", "Italy", "Spain", "Portugal", "Chile", "Argentina", "Austria", "Australia", "Germany")) %>%
  group_by(country) %>%
  summarise(avgPoints = mean(points)) %>%
  arrange(desc(avgPoints))
```


### Number Reviews Per Country (Top 10)

```{r reviewscountry, warning = FALSE}
winedata %>%
  group_by(country) %>%
  count(country) %>%
  arrange(desc(n)) %>%
  head(10) %>%
  ggplot(aes(x=fct_reorder(country, desc(n)), y=n, fill = country)) + 
  geom_col() +  xlab("Country") + ylab("Number of Reviews") + coord_flip() +
  theme(legend.position="none")
```

### Variety/Price Per Country (Top 10)

```{r varietycountry, warning= FALSE}
top_country_variety <- winedata %>%
  group_by(country) %>%
  filter(country %in% c("US","France","Italy","Spain","Portugal","Chile","Argentina","Austria","Australia","Germany")) %>%
  filter(variety %in% c("Pinot Noir", "Chardonnay","Cabernet Sauvignon","Red Blend", "Bordeaux-style Red Blend","Riesling","Sauvignon Blanc","Syrah","RosÃ©","Merlot"))
ggplot(top_country_variety, aes(x=country, y= price)) +  
  geom_jitter(alpha = 0.5, aes(color=variety)) +
  geom_boxplot(alpha = 0) +
  scale_y_log10() +  xlab("Country") + ylab("Price (Log Scale)") 
```
